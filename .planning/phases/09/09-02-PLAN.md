# Phase 9, Plan 2: Frontend — AI Badge & Tier Styling

## Goal
Display AI involvement indicators in the frontend: add `ai_assisted` to TypeScript types, show an AI badge in the event list and detail pages, and visually distinguish AI tier values in the ConfidenceIndicator component.

## Requirements Covered
- **AIM-03**: AI indicator displayed in the frontend event list as a visible badge, and in the event detail page
- **AIM-04**: MatchDecision `tier` field values `"ai"` and `"ai_low_confidence"` are visually distinguished in the ConfidenceIndicator component

## Files to Modify
1. `frontend/src/types/index.ts` — add `ai_assisted: boolean` to both interfaces
2. `frontend/src/components/EventList.tsx` — add AI badge next to event title
3. `frontend/src/components/EventDetail.tsx` — add AI badge in header badge row
4. `frontend/src/components/ConfidenceIndicator.tsx` — add tier-specific styled badges

## Tasks

### Task 1: TypeScript types update

**File:** `frontend/src/types/index.ts`

**What:** Add `ai_assisted: boolean` field to both `CanonicalEventSummary` and `CanonicalEventDetail` interfaces.

**Details:**

In `CanonicalEventSummary` (line 17, after `needs_review: boolean`):
```typescript
ai_assisted: boolean;
```

In `CanonicalEventDetail` (line 78, after `needs_review: boolean`):
```typescript
ai_assisted: boolean;
```

### Task 2: AI badge in EventList

**File:** `frontend/src/components/EventList.tsx`

**What:** Show a small purple "AI" badge inline next to the event title when `ai_assisted` is true.

**Details:**

In the title cell (line 106-112), add the badge AFTER the Link closing tag but still inside the `<td>`. The current code is:
```tsx
<td className="px-4 py-3">
  <Link
    to={`/events/${event.id}`}
    className="text-blue-600 hover:text-blue-800 hover:underline font-medium text-sm"
  >
    {event.title}
  </Link>
</td>
```

Change it to:
```tsx
<td className="px-4 py-3">
  <Link
    to={`/events/${event.id}`}
    className="text-blue-600 hover:text-blue-800 hover:underline font-medium text-sm"
  >
    {event.title}
  </Link>
  {event.ai_assisted && (
    <span className="ml-1.5 inline-block bg-purple-100 text-purple-800 text-xs px-1.5 py-0.5 rounded font-medium align-middle">
      AI
    </span>
  )}
</td>
```

The badge uses:
- Purple color scheme (`bg-purple-100 text-purple-800`) to distinguish from existing blue (categories) and yellow (review) badges
- `ml-1.5` for spacing from the title link
- `inline-block` + `align-middle` for proper vertical alignment with the text
- `text-xs px-1.5 py-0.5 rounded font-medium` — matches the existing badge pattern used by the Review badge (line 152)

### Task 3: AI badge in EventDetail header

**File:** `frontend/src/components/EventDetail.tsx`

**What:** Add a purple "AI Assisted" badge in the header badge row (the `flex flex-wrap gap-2` div on line 75) when `ai_assisted` is true.

**Details:**

In the header badge row (line 75-95), add the AI badge AFTER the `needs_review` badge (line 90-94) but still inside the `<div className="flex flex-wrap gap-2">`. The current code ends with:
```tsx
          {detail.needs_review && (
            <span className="inline-block bg-yellow-100 text-yellow-800 text-sm px-3 py-1 rounded font-medium">
              Needs Review
            </span>
          )}
        </div>
```

Add BEFORE the closing `</div>`:
```tsx
          {detail.ai_assisted && (
            <span className="inline-block bg-purple-100 text-purple-800 text-sm px-3 py-1 rounded font-medium">
              AI Assisted
            </span>
          )}
```

This follows the exact same pattern as the existing badges:
- `inline-block` layout
- `text-sm px-3 py-1 rounded` sizing (matches the source count and confidence badges)
- `font-medium` weight (matches the needs_review badge)
- Purple color scheme to distinguish from green (confidence), yellow (review), and gray (sources)

### Task 4: Tier-specific styling in ConfidenceIndicator

**File:** `frontend/src/components/ConfidenceIndicator.tsx`

**What:** Replace the plain text `{d.decision} ({d.tier})` (line 61-63) with a styled badge that visually distinguishes AI tiers from deterministic tiers.

**Details:**

First, add a helper function BEFORE the `ConfidenceIndicator` component (after the `ScoreBar` function, around line 36):

```tsx
function TierBadge({ tier }: { tier: string }) {
  const styles: Record<string, string> = {
    ai: 'bg-purple-100 text-purple-800',
    ai_low_confidence: 'bg-orange-100 text-orange-800',
    ai_unexpected: 'bg-red-100 text-red-800',
    deterministic: 'bg-gray-100 text-gray-600',
  };
  const labels: Record<string, string> = {
    ai: 'AI',
    ai_low_confidence: 'AI (low confidence)',
    ai_unexpected: 'AI (unexpected)',
    deterministic: 'Deterministic',
  };
  return (
    <span
      className={`text-xs px-2 py-0.5 rounded font-medium ${styles[tier] || styles.deterministic}`}
    >
      {labels[tier] || tier}
    </span>
  );
}
```

Then replace the decision/tier display on lines 61-63. The current code is:
```tsx
            <span className="ml-auto text-xs text-gray-500">
              {d.decision} ({d.tier})
            </span>
```

Replace with:
```tsx
            <span className="ml-auto flex items-center gap-1.5">
              <span className="text-xs text-gray-500">{d.decision}</span>
              <TierBadge tier={d.tier} />
            </span>
```

This separates the decision text (match/no_match/ambiguous) from the tier badge, and gives the tier its own visual weight:
- `"ai"` -> purple badge with "AI" label
- `"ai_low_confidence"` -> orange badge with "AI (low confidence)" label
- `"ai_unexpected"` -> red badge (edge case, but handled)
- `"deterministic"` -> subtle gray badge with "Deterministic" label
- Unknown tier values -> fall back to gray styling with raw tier string

## Verification

Start the frontend dev server and verify visually:
```bash
cd frontend && npm run dev
```

Check that TypeScript compiles without errors:
```bash
cd frontend && npx tsc --noEmit
```

Visual checks:
1. **Event List**: Events with `ai_assisted=true` show a small purple "AI" badge next to the title. Events without it show no badge.
2. **Event Detail**: The header badge row shows "AI Assisted" in purple alongside the existing source count, confidence, and review badges.
3. **ConfidenceIndicator**: Match decisions show colored tier badges:
   - Deterministic pairs show a gray "Deterministic" badge
   - AI-resolved pairs show a purple "AI" badge
   - Low-confidence AI pairs show an orange "AI (low confidence)" badge

## Dependencies
- Plan 1 (09-01) must be complete — the `ai_assisted` field must exist in the API response for the frontend to consume it
- The tier values (`"ai"`, `"ai_low_confidence"`, `"deterministic"`) already exist in the MatchDecision `tier` field from Phase 7 — no backend changes needed for AIM-04

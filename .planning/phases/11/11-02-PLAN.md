# Phase 11, Plan 2: Frontend — ChipSelector, Sorting, Page Size, and Filter Wiring

## Goal

Build the four UX improvements in the frontend: chip/tag selectors for city and category filters
(replacing the existing free-text inputs), sortable column headers on all 7 table columns, and a
configurable rows-per-page selector (25/50/100/200/ALL) in the Pagination component.
All state lives in URL params. No new npm dependencies.

## Requirements Covered

- **UIX-01**: Category filter replaced with `ChipSelector` — autocomplete from `/categories`, removable chips
- **UIX-02**: City filter replaced with `ChipSelector` — autocomplete from `/cities`, same behavior
- **UIX-03**: All 7 table column headers become sortable — click toggles asc/desc, active column shows ▲/▼
- **UIX-04**: Pagination gains a rows-per-page selector: 25, 50, 100, 200, ALL

## Files to Modify/Create

1. `frontend/src/types/index.ts` — extend `EventFilters`, add `SortColumn`/`SortDir` types
2. `frontend/src/api/client.ts` — add `fetchDistinctCategories`, `fetchDistinctCities`, update `fetchCanonicalEvents`
3. `frontend/src/hooks/useCanonicalEvents.ts` — add `useDistinctCategories`, `useDistinctCities` hooks
4. `frontend/src/components/ChipSelector.tsx` — NEW: reusable chip autocomplete component
5. `frontend/src/components/SearchFilters.tsx` — replace city/category inputs with `ChipSelector`
6. `frontend/src/components/Pagination.tsx` — add `size`/`onSizeChange` props and rows-per-page selector
7. `frontend/src/components/EventList.tsx` — add sort state, `SortableHeader`, `size` param, wire everything

---

## Tasks

### Task 1: Types, API client, and hooks

**Files:**
- `frontend/src/types/index.ts`
- `frontend/src/api/client.ts`
- `frontend/src/hooks/useCanonicalEvents.ts`

**What:** Extend the type layer, API client, and query hooks with the new multi-value filter fields,
sort params, and distinct-value fetch functions. This task must run first — all other tasks
import from these files.

**Details:**

**1. `frontend/src/types/index.ts` — update `EventFilters`, add sort types.**

Add these two type aliases BEFORE the `EventFilters` interface:

```typescript
export type SortColumn = 'title' | 'city' | 'date' | 'categories' | 'source_count' | 'confidence' | 'review';
export type SortDir = 'asc' | 'desc';
```

Replace the current `EventFilters` interface (lines 93-99) with:

```typescript
export interface EventFilters {
  q?: string;
  cities?: string[];     // was: city?: string  — now multi-value
  categories?: string[]; // was: category?: string — now multi-value
  date_from?: string;
  date_to?: string;
  sort_by?: SortColumn;
  sort_dir?: SortDir;
}
```

The old `city?: string` and `category?: string` fields are removed. No other types in the file
reference `EventFilters.city` or `EventFilters.category` directly.

**2. `frontend/src/api/client.ts` — three changes.**

a) Add import for the new types at the top:

```typescript
import type {
  CanonicalEventDetail, CanonicalEventSummary, EventFilters, PaginatedResponse,
  SplitRequest, SplitResponse, MergeRequest, MergeResponse,
  DismissRequest, AuditLogEntry, DashboardStats, ProcessingHistoryEntry,
  ConfigResponse, ConfigUpdateRequest,
} from '../types';
```

(The existing import already imports `EventFilters` — no change needed to the import line.
`SortColumn`/`SortDir` are used via `EventFilters` so no direct import needed.)

b) Update `fetchCanonicalEvents` to use multi-value params and sort:

```typescript
export async function fetchCanonicalEvents(
  filters: EventFilters,
  page: number = 1,
  size: number = 25,
): Promise<PaginatedResponse<CanonicalEventSummary>> {
  const params = new URLSearchParams();
  params.set('page', String(page));
  params.set('size', String(size));
  if (filters.q) params.set('q', filters.q);
  filters.cities?.forEach(c => params.append('city', c));
  filters.categories?.forEach(c => params.append('category', c));
  if (filters.date_from) params.set('date_from', filters.date_from);
  if (filters.date_to) params.set('date_to', filters.date_to);
  if (filters.sort_by) params.set('sort_by', filters.sort_by);
  if (filters.sort_dir) params.set('sort_dir', filters.sort_dir);

  const res = await fetch(`${API_BASE}/canonical-events?${params}`);
  if (!res.ok) throw new Error(`API error: ${res.status}`);
  return res.json();
}
```

c) Add the two new fetch functions after `fetchCanonicalEventDetail`:

```typescript
export async function fetchDistinctCategories(): Promise<string[]> {
  const res = await fetch(`${API_BASE}/canonical-events/categories`);
  if (!res.ok) throw new Error(`API error: ${res.status}`);
  return res.json();
}

export async function fetchDistinctCities(): Promise<string[]> {
  const res = await fetch(`${API_BASE}/canonical-events/cities`);
  if (!res.ok) throw new Error(`API error: ${res.status}`);
  return res.json();
}
```

**3. `frontend/src/hooks/useCanonicalEvents.ts` — add two new hooks.**

Add imports for the new fetch functions:

```typescript
import { useQuery, keepPreviousData } from '@tanstack/react-query';
import {
  fetchCanonicalEvents,
  fetchCanonicalEventDetail,
  fetchDistinctCategories,
  fetchDistinctCities,
} from '../api/client';
import type { EventFilters } from '../types';
```

Keep the existing `useCanonicalEvents` and `useCanonicalEventDetail` unchanged.
Add two new hooks after them:

```typescript
export function useDistinctCategories() {
  return useQuery({
    queryKey: ['distinct-categories'],
    queryFn: fetchDistinctCategories,
    staleTime: 300_000, // 5 min — values change only when new events are ingested
  });
}

export function useDistinctCities() {
  return useQuery({
    queryKey: ['distinct-cities'],
    queryFn: fetchDistinctCities,
    staleTime: 300_000,
  });
}
```

**Verification:**
```bash
cd /Users/svenkarl/workspaces/event-deduplication/frontend && npx tsc --noEmit 2>&1 | head -30
```

**Done:** TypeScript compiles with no errors on the three modified files. `EventFilters` has
`cities?: string[]` and `categories?: string[]`. `fetchDistinctCategories` and
`fetchDistinctCities` are exported from `client.ts`. `useDistinctCategories` and
`useDistinctCities` are exported from `useCanonicalEvents.ts`.

---

### Task 2: ChipSelector component, SearchFilters update, Pagination update, EventList update

**Files:**
- `frontend/src/components/ChipSelector.tsx` (new file)
- `frontend/src/components/SearchFilters.tsx`
- `frontend/src/components/Pagination.tsx`
- `frontend/src/components/EventList.tsx`

**What:** Create the new `ChipSelector` reusable component. Update `SearchFilters` to use it
for city and category. Add page-size selector to `Pagination`. Refactor `EventList` to include
sort state, sortable column headers, and `size` wired into pagination.

**Details:**

**1. `frontend/src/components/ChipSelector.tsx` — create new file.**

```typescript
import { useState } from 'react';

interface ChipSelectorProps {
  label: string;
  options: string[];           // full list fetched from API
  selected: string[];          // currently selected values (controlled)
  onChange: (values: string[]) => void;
  placeholder?: string;
}

export function ChipSelector({ label, options, selected, onChange, placeholder }: ChipSelectorProps) {
  const [inputValue, setInputValue] = useState('');
  const [isOpen, setIsOpen] = useState(false);

  const filtered = options.filter(
    o => o.toLowerCase().includes(inputValue.toLowerCase()) && !selected.includes(o)
  );

  const addItem = (item: string) => {
    onChange([...selected, item]);
    setInputValue('');
    setIsOpen(false);
  };

  const removeItem = (item: string) => {
    onChange(selected.filter(s => s !== item));
  };

  return (
    <div className="relative min-w-[160px]">
      <label className="block text-xs font-medium text-gray-600 mb-1">{label}</label>
      {/* Selected chips */}
      {selected.length > 0 && (
        <div className="flex flex-wrap gap-1 mb-1">
          {selected.map(item => (
            <span
              key={item}
              className="inline-flex items-center gap-1 bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded"
            >
              {item}
              <button
                type="button"
                onClick={() => removeItem(item)}
                className="hover:text-blue-600 leading-none"
                aria-label={`Remove ${item}`}
              >
                &times;
              </button>
            </span>
          ))}
        </div>
      )}
      {/* Autocomplete input */}
      <input
        type="text"
        value={inputValue}
        onChange={e => { setInputValue(e.target.value); setIsOpen(true); }}
        onFocus={() => setIsOpen(true)}
        onBlur={() => setTimeout(() => setIsOpen(false), 150)}
        placeholder={placeholder ?? `Add ${label.toLowerCase()}...`}
        className="w-full px-3 py-1.5 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"
      />
      {/* Dropdown */}
      {isOpen && filtered.length > 0 && (
        <ul className="absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded shadow-lg max-h-48 overflow-auto">
          {filtered.map(item => (
            <li
              key={item}
              onMouseDown={() => addItem(item)}
              className="px-3 py-1.5 text-sm hover:bg-blue-50 cursor-pointer"
            >
              {item}
            </li>
          ))}
        </ul>
      )}
    </div>
  );
}
```

Key implementation notes:
- `onMouseDown` (not `onClick`) on dropdown items prevents the `onBlur` timing issue where
  blur fires before click, closing the dropdown before the selection registers.
- `setTimeout(..., 150)` in `onBlur` gives the mousedown event time to fire.
- Parent owns `selected` state — chips apply immediately via `onChange` without a form submit.

**2. `frontend/src/components/SearchFilters.tsx` — replace city and category inputs.**

Rewrite the entire file. Keep the form structure but:
- Remove local `localFilters` state for city and category (they are now in URL via parent)
- Keep `localFilters` only for `q`, `date_from`, `date_to` (text/date fields that still use form submit)
- Add `useDistinctCategories` and `useDistinctCities` hooks
- Replace the city `<input>` with `<ChipSelector>`
- Replace the category `<input>` with `<ChipSelector>`
- ChipSelector `onChange` calls `onFiltersChange` immediately (no form submit)

```typescript
import { useState, type FormEvent } from 'react';
import type { EventFilters } from '../types';
import { ChipSelector } from './ChipSelector';
import { useDistinctCategories, useDistinctCities } from '../hooks/useCanonicalEvents';

interface SearchFiltersProps {
  filters: EventFilters;
  onFiltersChange: (filters: EventFilters) => void;
}

export function SearchFilters({ filters, onFiltersChange }: SearchFiltersProps) {
  // Local state only for text fields that require form submit
  const [localQ, setLocalQ] = useState(filters.q ?? '');
  const [localDateFrom, setLocalDateFrom] = useState(filters.date_from ?? '');
  const [localDateTo, setLocalDateTo] = useState(filters.date_to ?? '');

  const { data: categoryOptions = [] } = useDistinctCategories();
  const { data: cityOptions = [] } = useDistinctCities();

  function handleSubmit(e: FormEvent) {
    e.preventDefault();
    onFiltersChange({
      ...filters,
      q: localQ || undefined,
      date_from: localDateFrom || undefined,
      date_to: localDateTo || undefined,
    });
  }

  function handleClear() {
    setLocalQ('');
    setLocalDateFrom('');
    setLocalDateTo('');
    onFiltersChange({});
  }

  return (
    <form onSubmit={handleSubmit} className="bg-white rounded-lg shadow-sm border p-4 mb-4">
      <div className="flex flex-wrap gap-3 items-end">
        <div className="flex-1 min-w-[160px]">
          <label className="block text-xs font-medium text-gray-600 mb-1">Title search</label>
          <input
            type="text"
            placeholder="Search events..."
            value={localQ}
            onChange={e => setLocalQ(e.target.value)}
            className="w-full px-3 py-1.5 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"
          />
        </div>
        <ChipSelector
          label="City"
          options={cityOptions}
          selected={filters.cities ?? []}
          onChange={cities => onFiltersChange({ ...filters, cities })}
          placeholder="Add city..."
        />
        <div className="min-w-[140px]">
          <label className="block text-xs font-medium text-gray-600 mb-1">Date from</label>
          <input
            type="date"
            value={localDateFrom}
            onChange={e => setLocalDateFrom(e.target.value)}
            className="w-full px-3 py-1.5 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"
          />
        </div>
        <div className="min-w-[140px]">
          <label className="block text-xs font-medium text-gray-600 mb-1">Date to</label>
          <input
            type="date"
            value={localDateTo}
            onChange={e => setLocalDateTo(e.target.value)}
            className="w-full px-3 py-1.5 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"
          />
        </div>
        <ChipSelector
          label="Category"
          options={categoryOptions}
          selected={filters.categories ?? []}
          onChange={categories => onFiltersChange({ ...filters, categories })}
          placeholder="Add category..."
        />
        <div className="flex gap-2">
          <button
            type="submit"
            className="px-4 py-1.5 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
          >
            Search
          </button>
          <button
            type="button"
            onClick={handleClear}
            className="px-4 py-1.5 bg-gray-100 text-gray-700 text-sm rounded hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-400"
          >
            Clear
          </button>
        </div>
      </div>
    </form>
  );
}
```

**3. `frontend/src/components/Pagination.tsx` — add size selector.**

Rewrite the file. Add `size` and `onSizeChange` props. Add a rows-per-page `<select>` on the left.

```typescript
const PAGE_SIZE_OPTIONS = [25, 50, 100, 200, 0] as const;
const PAGE_SIZE_LABELS: Record<number, string> = { 0: 'ALL', 25: '25', 50: '50', 100: '100', 200: '200' };

interface PaginationProps {
  page: number;
  pages: number;
  total: number;
  size: number;
  onPageChange: (page: number) => void;
  onSizeChange: (size: number) => void;
}

export function Pagination({ page, pages, total, size, onPageChange, onSizeChange }: PaginationProps) {
  return (
    <div className="flex items-center justify-between mt-4 px-1">
      {/* Left: rows-per-page selector */}
      <div className="flex items-center gap-2">
        <span className="text-xs text-gray-500">Rows:</span>
        <select
          value={size}
          onChange={e => onSizeChange(Number(e.target.value))}
          className="text-sm border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-blue-500"
        >
          {PAGE_SIZE_OPTIONS.map(opt => (
            <option key={opt} value={opt}>{PAGE_SIZE_LABELS[opt]}</option>
          ))}
        </select>
      </div>
      {/* Center: page info */}
      <span className="text-sm text-gray-600">
        Page {page} of {pages} ({total} results)
      </span>
      {/* Right: prev/next */}
      <div className="flex gap-2">
        <button
          onClick={() => onPageChange(page - 1)}
          disabled={page <= 1}
          className="px-3 py-1.5 text-sm border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-40 disabled:cursor-not-allowed"
        >
          Previous
        </button>
        <button
          onClick={() => onPageChange(page + 1)}
          disabled={page >= pages}
          className="px-3 py-1.5 text-sm border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-40 disabled:cursor-not-allowed"
        >
          Next
        </button>
      </div>
    </div>
  );
}
```

Size `0` in the select maps to "ALL". The parent (`EventList`) converts `size === 0` to
`size = 10000` before passing it to `useCanonicalEvents` and the API.

**4. `frontend/src/components/EventList.tsx` — add sort state, sortable headers, size, and wire.**

Full rewrite. Key changes:
- `parseFiltersFromParams` reads multi-value `cities`/`categories` via `getAll()`, reads
  `sort_by`, `sort_dir`, and `size` from URL params
- `filtersToParams` serializes multi-value arrays via `.append()`, includes sort and size
- New `SortableHeader` component inside the file (not exported) handles header click and indicators
- `handleSortChange` toggles `sort_dir` if same column is clicked, resets to `asc` for new column
- `handleSizeChange` resets page to 1 on size change
- `useCanonicalEvents` receives `size` — converts `0` (ALL) to `10000`
- `<Pagination>` receives new `size` and `onSizeChange` props

```typescript
import { useCallback, useMemo } from 'react';
import { Link, useSearchParams } from 'react-router-dom';
import { format, parseISO } from 'date-fns';
import { useCanonicalEvents } from '../hooks/useCanonicalEvents';
import { SearchFilters } from './SearchFilters';
import { Pagination } from './Pagination';
import type { EventFilters, SortColumn, SortDir } from '../types';

function parseFiltersFromParams(params: URLSearchParams): EventFilters {
  return {
    q:          params.get('q') ?? undefined,
    cities:     params.getAll('city'),
    categories: params.getAll('category'),
    date_from:  params.get('date_from') ?? undefined,
    date_to:    params.get('date_to') ?? undefined,
    sort_by:    (params.get('sort_by') ?? 'title') as SortColumn,
    sort_dir:   (params.get('sort_dir') ?? 'asc') as SortDir,
  };
}

function filtersToParams(filters: EventFilters, page: number, size: number): URLSearchParams {
  const params = new URLSearchParams();
  if (filters.q) params.set('q', filters.q);
  filters.cities?.forEach(c => params.append('city', c));
  filters.categories?.forEach(c => params.append('category', c));
  if (filters.date_from) params.set('date_from', filters.date_from);
  if (filters.date_to) params.set('date_to', filters.date_to);
  if (filters.sort_by && filters.sort_by !== 'title') params.set('sort_by', filters.sort_by);
  if (filters.sort_dir && filters.sort_dir !== 'asc') params.set('sort_dir', filters.sort_dir);
  if (size !== 25) params.set('size', String(size));
  if (page > 1) params.set('page', String(page));
  return params;
}

function formatDate(dateStr: string): string {
  try { return format(parseISO(dateStr), 'dd.MM.yyyy'); }
  catch { return dateStr; }
}

function formatConfidence(confidence: number | null): string {
  if (confidence === null) return '-';
  return Math.round(confidence * 100) + '%';
}

interface SortableHeaderProps {
  label: string;
  column: SortColumn;
  currentSort: SortColumn;
  currentDir: SortDir;
  onSort: (col: SortColumn) => void;
  align?: 'left' | 'center';
}

function SortableHeader({ label, column, currentSort, currentDir, onSort, align = 'left' }: SortableHeaderProps) {
  const isActive = column === currentSort;
  const indicator = isActive ? (currentDir === 'asc' ? ' \u25b2' : ' \u25bc') : ' \u2195';
  return (
    <th
      className={`px-4 py-3 cursor-pointer select-none hover:bg-gray-100 ${align === 'center' ? 'text-center' : ''}`}
      onClick={() => onSort(column)}
    >
      <span className="inline-flex items-center gap-0.5">
        {label}{indicator}
      </span>
    </th>
  );
}

export function EventList() {
  const [searchParams, setSearchParams] = useSearchParams();

  const filters = useMemo(() => parseFiltersFromParams(searchParams), [searchParams]);
  const page = Number(searchParams.get('page') ?? '1');
  // size=0 means ALL in the UI; convert to 10000 for the API
  const sizeParam = Number(searchParams.get('size') ?? '25');
  const apiSize = sizeParam === 0 ? 10000 : sizeParam;

  const { data, isLoading, isError, error } = useCanonicalEvents(filters, page, apiSize);

  const handleFiltersChange = useCallback(
    (newFilters: EventFilters) => {
      setSearchParams(filtersToParams(newFilters, 1, sizeParam));
    },
    [setSearchParams, sizeParam],
  );

  const handlePageChange = useCallback(
    (newPage: number) => {
      setSearchParams(filtersToParams(filters, newPage, sizeParam));
    },
    [setSearchParams, filters, sizeParam],
  );

  const handleSortChange = useCallback(
    (column: SortColumn) => {
      const newDir: SortDir =
        filters.sort_by === column && filters.sort_dir === 'asc' ? 'desc' : 'asc';
      setSearchParams(
        filtersToParams({ ...filters, sort_by: column, sort_dir: newDir }, 1, sizeParam)
      );
    },
    [setSearchParams, filters, sizeParam],
  );

  const handleSizeChange = useCallback(
    (newSize: number) => {
      // Always reset to page 1 when changing page size
      setSearchParams(filtersToParams(filters, 1, newSize));
    },
    [setSearchParams, filters],
  );

  const sortBy = filters.sort_by ?? 'title';
  const sortDir = filters.sort_dir ?? 'asc';

  return (
    <div>
      <SearchFilters filters={filters} onFiltersChange={handleFiltersChange} />

      {isLoading && (
        <div className="text-center py-12 text-gray-500">Loading events...</div>
      )}
      {isError && (
        <div className="text-center py-12 text-red-600">
          Error loading events: {error instanceof Error ? error.message : 'Unknown error'}
        </div>
      )}
      {data && data.items.length === 0 && (
        <div className="text-center py-12 text-gray-500">No events found.</div>
      )}

      {data && data.items.length > 0 && (
        <>
          <div className="bg-white rounded-lg shadow-sm border overflow-hidden">
            <table className="w-full">
              <thead>
                <tr className="border-b bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  <SortableHeader label="Title"      column="title"        currentSort={sortBy} currentDir={sortDir} onSort={handleSortChange} />
                  <SortableHeader label="City"       column="city"         currentSort={sortBy} currentDir={sortDir} onSort={handleSortChange} />
                  <SortableHeader label="Date"       column="date"         currentSort={sortBy} currentDir={sortDir} onSort={handleSortChange} />
                  <SortableHeader label="Categories" column="categories"   currentSort={sortBy} currentDir={sortDir} onSort={handleSortChange} />
                  <SortableHeader label="Sources"    column="source_count" currentSort={sortBy} currentDir={sortDir} onSort={handleSortChange} align="center" />
                  <SortableHeader label="Confidence" column="confidence"   currentSort={sortBy} currentDir={sortDir} onSort={handleSortChange} align="center" />
                  <SortableHeader label="Review"     column="review"       currentSort={sortBy} currentDir={sortDir} onSort={handleSortChange} align="center" />
                </tr>
              </thead>
              <tbody className="divide-y divide-gray-100">
                {data.items.map((event) => (
                  <tr key={event.id} className="hover:bg-gray-50">
                    <td className="px-4 py-3">
                      <Link
                        to={`/events/${event.id}`}
                        className="text-blue-600 hover:text-blue-800 hover:underline font-medium text-sm"
                      >
                        {event.title}
                      </Link>
                      {event.ai_assisted && (
                        <span className="ml-1.5 inline-block bg-purple-100 text-purple-800 text-xs px-1.5 py-0.5 rounded font-medium align-middle">
                          AI
                        </span>
                      )}
                    </td>
                    <td className="px-4 py-3 text-sm text-gray-600">{event.location_city ?? '-'}</td>
                    <td className="px-4 py-3 text-sm text-gray-600">
                      {event.dates && event.dates.length > 0 ? formatDate(event.dates[0].date) : '-'}
                    </td>
                    <td className="px-4 py-3">
                      <div className="flex flex-wrap gap-1">
                        {event.categories?.map(cat => (
                          <span key={cat} className="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded">
                            {cat}
                          </span>
                        ))}
                      </div>
                    </td>
                    <td className="px-4 py-3 text-sm text-gray-600 text-center">{event.source_count}</td>
                    <td className="px-4 py-3 text-sm text-center">
                      <span className={
                        event.match_confidence !== null && event.match_confidence >= 0.8
                          ? 'text-green-700'
                          : event.match_confidence !== null && event.match_confidence >= 0.5
                            ? 'text-yellow-700'
                            : 'text-gray-500'
                      }>
                        {formatConfidence(event.match_confidence)}
                      </span>
                    </td>
                    <td className="px-4 py-3 text-center">
                      {event.needs_review && (
                        <span className="inline-block bg-yellow-100 text-yellow-800 text-xs px-2 py-0.5 rounded font-medium">
                          Review
                        </span>
                      )}
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>

          <Pagination
            page={data.page}
            pages={data.pages}
            total={data.total}
            size={sizeParam}
            onPageChange={handlePageChange}
            onSizeChange={handleSizeChange}
          />
        </>
      )}
    </div>
  );
}
```

**Verification:**
```bash
cd /Users/svenkarl/workspaces/event-deduplication/frontend && npx tsc --noEmit 2>&1 | head -40
```

Also verify the dev build compiles:
```bash
cd /Users/svenkarl/workspaces/event-deduplication/frontend && npm run build 2>&1 | tail -20
```

**Done:** TypeScript compiles with zero errors. Build succeeds. All 7 table headers are sortable
(`SortableHeader` renders with click handlers). `Pagination` renders a rows-per-page select with
options 25/50/100/200/ALL. `SearchFilters` shows `ChipSelector` for city and category (no plain
text inputs for those two fields). Chip changes update the URL immediately without form submit.
Selecting ALL sends `size=10000` to the API.

---

## Verification

Full type check:
```bash
cd /Users/svenkarl/workspaces/event-deduplication/frontend && npx tsc --noEmit
```

Production build:
```bash
cd /Users/svenkarl/workspaces/event-deduplication/frontend && npm run build
```

Lint (if configured):
```bash
cd /Users/svenkarl/workspaces/event-deduplication/frontend && npm run lint 2>/dev/null || echo "no lint script"
```

## Dependencies

- **Requires 11-01-PLAN.md to be executed first** — the `/categories` and `/cities` API endpoints
  must exist before the frontend can fetch autocomplete options.
- No new npm packages required.

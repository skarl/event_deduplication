# Milestone Audit: v0.2

**Date:** 2026-02-28
**Status:** PASSED
**Phases:** 5 (all complete)
**Plans:** 10/10 complete
**Tests:** 445/445 pass

## Requirements Coverage

**20/20 v0.2 requirements implemented in code.**

| Category | Count | Status |
|----------|-------|--------|
| Dynamic Configuration (CFG) | 5/5 | All implemented |
| AI Matching Verification (AIM) | 4/4 | All implemented |
| Time Gap Penalty (TGP) | 2/2 | All implemented |
| Frontend UX Improvements (UIX) | 4/4 | All implemented |
| Export Function (EXP) | 5/5 | All implemented |

### Detailed Requirement Verification

| Req | Description | Evidence |
|-----|------------|----------|
| CFG-01 | DB-backed config with REST API | `config_settings` table, GET/PATCH `/api/config`, per-run loading in `load_config_for_run()` |
| CFG-02 | Frontend config page | `ConfigPage.tsx` (751 lines), 7 editable sections with per-section save |
| CFG-03 | Encrypted API key, write-only | Fernet encryption in `encryption.py`, `has_api_key` boolean in GET response, never returns key |
| CFG-04 | AI on/off toggle | `ai.enabled` field in config, toggle switch in frontend, respected by `resolver.py` |
| CFG-05 | All params editable | Scoring weights, thresholds, date/time, geo, title, AI, clustering — all in DB + frontend |
| AIM-01 | E2E AI verification | `test_ai_e2e.py` — 8 tests including full flow with mock Gemini |
| AIM-02 | ai_assisted flag on CanonicalEvent | `ai_assisted: Mapped[bool]` column, migration 006, computed in pipeline |
| AIM-03 | AI badge in frontend | Purple "AI" badge in EventList + EventDetail header |
| AIM-04 | Tier-specific styling | TierBadge component: purple (ai), orange (ai_low_confidence), gray (deterministic) |
| TGP-01 | 2h+ time gap penalty | 4th tier in `_time_proximity_factor()`: 0.15 factor for gaps > `time_gap_penalty_hours` |
| TGP-02 | Configurable penalty params | `time_gap_penalty_hours` and `time_gap_penalty_factor` in DateConfig, editable in frontend |
| UIX-01 | Category chip selector | `ChipSelector` component, `/categories` endpoint, AND semantics |
| UIX-02 | City chip selector | `ChipSelector` component, `/cities` endpoint, OR semantics |
| UIX-03 | Column sorting | `SortableHeader` component, 7 sortable columns, `sort_by`/`sort_dir` API params, nullslast/nullsfirst |
| UIX-04 | Configurable rows per page | Pagination with 25/50/100/200/ALL options, `size` up to 10000 |
| EXP-01 | Export API endpoint | `POST /api/export`, JSON or ZIP response, input-format transformation |
| EXP-02 | Date filter on export | `created_after` and `modified_after` optional datetime filters |
| EXP-03 | File splitting (200/file) | `chunk_events()` with correct part/totalParts metadata |
| EXP-04 | Frontend export UI | `ExportPage.tsx` with datetime pickers, blob download |
| EXP-05 | CLI export command | `python -m event_dedup.cli export` with `--created-after`, `--modified-after`, `--output-dir` |

## Cross-Phase Integration

All 6 integration points verified:

| Integration | Status | Evidence |
|-------------|--------|----------|
| Phase 8 → 9 (Config → AI pipeline) | PASS | `load_config_for_run()` loads from DB; `resolver.py` checks `ai.enabled` and `ai.api_key` |
| Phase 8 → 10 (Config → Scorers) | PASS | `date_scorer.py` uses `time_gap_penalty_*`; `geo_scorer.py` uses `venue_*` from config |
| Phase 9 → 11 (AI indicator → Frontend) | PASS | `ai_assisted` in TypeScript types, purple badge in EventList |
| Phase 8 → 10 → Frontend (Config editability) | PASS | All 4 new params editable in ConfigPage |
| Phase 12 (Export completeness) | PASS | Transforms all event fields; `ai_assisted` intentionally excluded (operational metadata, not input format) |
| Frontend routing | PASS | All routes registered: `/`, `/events/:id`, `/review`, `/dashboard`, `/config`, `/export` |

## Test Results

```
445 passed in 2.48s
```

| Phase | Tests Added | Cumulative |
|-------|------------|------------|
| 8 | 9 (config API) | 380 |
| 9 | 8 (AI e2e) | 388 |
| 10 | 10 (date/venue scoring) | 398 |
| 11 | 9 (multi-filter, sort, size) | 407 |
| 12 | 24 (19 export + 5 CLI) | 437 |
| Post-phase fixes | 8 (title veto) | 445 |

## Performance Metrics

| Phase | Plans | Total Duration | Commits |
|-------|-------|---------------|---------|
| 8 | 2 | ~8m 20s | 4 |
| 9 | 2 | ~6m | 2 |
| 10 | 2 | ~4m | 3 |
| 11 | 2 | ~5m | 4 |
| 12 | 2 | ~6m 16s | 4 |
| **Total** | **10** | **~30m** | **17** |

## Documentation Gaps (non-blocking)

| Issue | Severity | Detail |
|-------|----------|--------|
| Phase 11 missing SUMMARY files | Low | `11-01-SUMMARY.md` and `11-02-SUMMARY.md` never created despite phase being fully implemented. Plans exist and code is complete. |
| Phase 11 missing UAT | Low | No `11-UAT.md` file, though all UIX requirements verified in code and tests |
| REQUIREMENTS.md stale checkboxes | Low | Many requirements showed `[ ]` despite being complete. Fixed during this audit. |

## Tech Debt

- None identified. All phases clean, no workarounds or temporary hacks.

## Decisions Log (v0.2)

| Decision | Phase | Rationale |
|----------|-------|-----------|
| Singleton config row (id=1) | 8 | No multi-tenant complexity needed |
| Fernet encryption with plain-text fallback | 8 | Dev convenience without sacrificing prod security |
| HTML details/summary for config sections | 8 | Native, no extra dependencies |
| ai_assisted computed in pipeline | 9 | Avoid N+1 queries; single-pass computation |
| tier.startsWith("ai") matching | 9 | Catches all AI tier variants |
| 4-tier time proximity model | 10 | exact/close/far/gap — was 3-tier |
| Venue matching only within <1km | 10 | Avoids penalizing distant events with similar venue names |
| Multi-value city OR, category AND | 11 | City = "show events in any of these cities"; Category = "must have all selected categories" |
| size=0 maps to 10000 for ALL | 11 | Sentinel value in UI, safe upper bound in API |
| POST for export endpoint | 12 | Body parameters for datetime filters |
| Exclude ai_assisted from export | 12 | Export mirrors input format; ai_assisted is operational metadata |
| Title veto threshold (0.30) | Post-phase | Prevents auto-merge when titles clearly differ (cinema scenario) |

## Verdict

**PASSED** — All 20 requirements implemented and verified. 445 tests pass. All cross-phase integrations functional. No tech debt. Ready for v0.2 completion.
